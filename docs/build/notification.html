

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Notification Flag Gadget &mdash; Alexa-Gadgets-Raspberry-Pi-Samples 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Timer Gadget" href="timer.html" />
    <link rel="prev" title="Wake Word LED Gadget Example" href="wakeword.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Alexa-Gadgets-Raspberry-Pi-Samples
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Python API</a></li>
</ul>
<p class="caption"><span class="caption-text">Projects</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="colorcycler.html">Color Cycler</a></li>
<li class="toctree-l1"><a class="reference internal" href="kitchensink.html">Kitchen Sink</a></li>
<li class="toctree-l1"><a class="reference internal" href="wakeword.html">Wake Word</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Notification</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-1-connect-the-servo-to-your-pi">Step 1: Connect the servo to your Pi</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-2-configure-your-credentials">Step 2: Configure your credentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-3-explore-the-example">Step 3: Explore the example</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#code">Code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#step-4-test-your-gadget">Step 4: Test your gadget</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-5-assemble-your-gadget">Step 5: Assemble your gadget</a></li>
<li class="toctree-l2"><a class="reference internal" href="#what-s-next">What’s next</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="timer.html">Timer</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Alexa-Gadgets-Raspberry-Pi-Samples</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Notification Flag Gadget</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="notification-flag-gadget">
<h1>Notification Flag Gadget<a class="headerlink" href="#notification-flag-gadget" title="Permalink to this headline">¶</a></h1>
<a class="reference external image-reference" href="_static/images/notification_gadget.png"><img alt="Hardware requirements" src="_images/notification_gadget.png" /></a>
<p><strong>This guide steps through the process of creating an Alexa Gadget that rotates a servo to raise and lower a flag when a notification is received or cleared on a paired Echo device.</strong></p>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<a class="reference external image-reference" href="_static/images/pi_servo_hardware.png"><img alt="Hardware requirements" src="_images/pi_servo_hardware.png" /></a>
<p>In order to to run this example <strong>you should already have</strong> a Raspberry Pi with the <strong>Alexa-Gadgets-Raspberry-Pi-Samples software</strong> installed. Learn more in the <a class="reference external" href="overview.html">project README</a>. In addition, you will need the following hardware:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.amazon.com/DIKAVS-Break-Away-2x20-pin-Header-Raspberry/dp/B075VNBD3R">Header pins</a> soldered to your Raspberry Pi (used for connecting hardware)</p></li>
<li><p><a class="reference external" href="https://www.amazon.com/MakerDoIt-Micro-Arduino-Walking-Control/dp/B07C5PGD3Q/">Micro servo</a></p></li>
<li><p>Three male-female <a class="reference external" href="https://www.amazon.com/LANDZO-Multicolored-Breadboard-Raspberry-Arduino/dp/B01IB7UOFE/">jumper wires</a></p></li>
</ul>
</div>
<div class="section" id="step-1-connect-the-servo-to-your-pi">
<h2>Step 1: Connect the servo to your Pi<a class="headerlink" href="#step-1-connect-the-servo-to-your-pi" title="Permalink to this headline">¶</a></h2>
<p>The following steps walk you through connecting the servo:</p>
<ol class="arabic simple">
<li><p>Make sure your Raspberry Pi is powered off.</p></li>
<li><p>Connect jumper wires to the 5V, GPIO25 (Pin 22), and GRND pins. <a class="reference external" href="https://www.raspberrypi.org/documentation/usage/gpio/">Learn more</a></p></li>
<li><p>Connect jumper wires to the servo using the diagram below. Red is power, black/brown is ground, and yellow/orange is signal.</p></li>
<li><p>Once you’ve connected the servo to the Pi, start up your Pi.</p></li>
</ol>
<a class="reference external image-reference" href="_static/images/servo_to_rpi.png"><img alt="Servo to Raspberry Pi Diagram" src="_images/servo_to_rpi.png" /></a>
</div>
<div class="section" id="step-2-configure-your-credentials">
<h2>Step 2: Configure your credentials<a class="headerlink" href="#step-2-configure-your-credentials" title="Permalink to this headline">¶</a></h2>
<p>Now that the servo is connected to your Pi, you can continue on with the example.</p>
<p>As with any example, you’ll need to first add the credentials that are associated with the gadget you created in the <a class="reference external" href="https://developer.amazon.com/avs/home.html#/avs/home">Alexa Voice Service Developer Console</a>:</p>
<ol class="arabic simple">
<li><p>On the command line of your Pi, navigate to <code class="docutils literal notranslate"><span class="pre">/home/pi/Alexa-Gadgets-Raspberry-Pi-Samples/src/examples/notification</span></code> and open the <code class="docutils literal notranslate"><span class="pre">notification_gadget.ini</span></code> file within that folder.</p></li>
<li><p>Change the <code class="docutils literal notranslate"><span class="pre">amazonId</span></code> from <code class="docutils literal notranslate"><span class="pre">YOUR_GADGET_AMAZON_ID</span></code> to the <strong>Amazon ID</strong> that is displayed on the gadget’s product page in the Alexa Voice Service Developer Console.</p></li>
<li><p>Change the <code class="docutils literal notranslate"><span class="pre">alexaGadgetSecret</span></code> from <code class="docutils literal notranslate"><span class="pre">YOUR_GADGET_SECRET</span></code> to the <strong>Alexa Gadget Secret</strong> that is displayed on the gadget’s product page in the Alexa Voice Service Developer Console.</p></li>
</ol>
<p>To learn more, refer to <a class="reference external" href="https://developer.amazon.com/docs/alexa-gadgets-toolkit/register-gadget.html">Register a Gadget</a> in the Alexa Gadgets Toolkit documentation.</p>
</div>
<div class="section" id="step-3-explore-the-example">
<h2>Step 3: Explore the example<a class="headerlink" href="#step-3-explore-the-example" title="Permalink to this headline">¶</a></h2>
<p>The example follows the same model as other examples that you can browse within the Alexa-Gadgets-Raspberry-Pi-Samples project.</p>
<div class="section" id="configuration">
<h3>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h3>
<p>Within the <code class="docutils literal notranslate"><span class="pre">notification_gadget.ini</span></code> file, in addition to the credentials you just modified, you will see a group of <code class="docutils literal notranslate"><span class="pre">[GadgetCapabilities]</span></code> that this gadget is registering for. In this case, it is registering for notifications:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">GadgetCapabilities</span><span class="p">]</span>
<span class="n">Notifications</span> <span class="o">=</span> <span class="mi">1</span><span class="p">.</span><span class="mi">0</span>
</pre></div>
</div>
<p>In this example, you will be using version 1.0 of the <a class="reference external" href="https://developer.amazon.com/docs/alexa-gadgets-toolkit/notifications-interface.html">Notifications interface</a>, and responding to the setting and clearing of notifications received on the paired Echo device.</p>
</div>
<div class="section" id="code">
<h3>Code<a class="headerlink" href="#code" title="Permalink to this headline">¶</a></h3>
<p>Within <code class="docutils literal notranslate"><span class="pre">notification_gadget.py</span></code>, you’ll notice the import and use of Raspberry Pi’s GPIO capabilities using the <a class="reference external" href="https://gpiozero.readthedocs.io">gpiozero</a> library:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">gpiozero</span> <span class="kn">import</span> <span class="n">AngularServo</span>
</pre></div>
</div>
<p>You’ll also see the configuration of servo motor using gpiozero’s AngularServo:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SERVO</span> <span class="o">=</span> <span class="n">AngularServo</span><span class="p">(</span><span class="n">GPIO_PIN</span><span class="p">,</span> <span class="n">initial_angle</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span> <span class="n">min_pulse_width</span><span class="o">=</span><span class="mf">0.0005</span><span class="p">,</span> <span class="n">max_pulse_width</span><span class="o">=</span><span class="mf">0.002</span><span class="p">)</span>
</pre></div>
</div>
<p>You’ll see callbacks for the setting and clearing of notifications that can be used to control the servo:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">on_notifications_setindicator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directive</span><span class="p">):</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Notification set - set servo to 0 degrees&#39;</span><span class="p">)</span>

    <span class="c1"># Set angle of servo to 0 degrees</span>
    <span class="n">SERVO</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SERVO</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">on_notifications_clearindicator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directive</span><span class="p">):</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Notification cleared - set servo to -90 degrees&#39;</span><span class="p">)</span>

    <span class="c1"># Set angle of servo to -90 degrees</span>
    <span class="n">SERVO</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="o">-</span><span class="mi">90</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">SERVO</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span>
</pre></div>
</div>
<p>The above callbacks are listening for the set and cleared states of the notifications received by the paired Echo device to rotate the servo to 90 degrees when a notification is set, and to 0 degrees when notifications are cleared from the paired Echo device.</p>
</div>
</div>
<div class="section" id="step-4-test-your-gadget">
<h2>Step 4: Test your gadget<a class="headerlink" href="#step-4-test-your-gadget" title="Permalink to this headline">¶</a></h2>
<p>In order for this gadget to function, it will need to be paired to a <a class="reference external" href="https://developer.amazon.com/docs/alexa-gadgets-toolkit/understand-alexa-gadgets-toolkit.html#devices">compatible Echo device</a>. Before running the example, refer to the <a class="reference external" href="overview.html">pairing guide</a> to learn how to pair your gadget.</p>
<p>With your Echo device nearby, run the Python code:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">notification_gadget</span><span class="p">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Once your gadget paired/connected, try the following commands:</p>
<p><em>“Alexa, ask Quote Maker to send a notification”</em></p>
<p>To trigger a notification, you can use the Quote Maker skill (US only). If the Skill is not enabled, Alexa will prompt you to do so. When the notification is triggered, the servo should rotate to 90 degrees.</p>
<p><em>“Alexa, clear my notifications”</em></p>
<p>This will clear your notifications and cause the servo to rotate to its starting position at 0 degrees. This will also happen if you listen to your notifications by saying, “Alexa, what are my notifications?”</p>
<p>In each case, you should see a message printed whenever the servo runs, and see/hear the servo move. Note the direction the servo moves. This will help when assembling the physical components of your gadget.</p>
</div>
<div class="section" id="step-5-assemble-your-gadget">
<h2>Step 5: Assemble your gadget<a class="headerlink" href="#step-5-assemble-your-gadget" title="Permalink to this headline">¶</a></h2>
<p>The housing and flag shown in the image above were constructed from laser-cut wood, but any other objects and materials will work. It also doesn’t have to be a flag at all. Below is a template for the flag and housing for reference, which you can print out, transfer to cardboard, and assemble:</p>
<p><a class="reference external" href="_static/pdfs/Notification-Flag-Template.pdf">Notification-Flag-Template.pdf</a></p>
<a class="reference external image-reference" href="_static/images/notification_flag_template.png"><img alt="Hardware requirements" src="_images/notification_flag_template.png" /></a>
<p>You can use <a class="reference external" href="https://www.youtube.com/watch?v=Gl8i4IYIEXw">this technique</a> to transfer the printed template to cardboard. Once transferred, cut the pieces out and fold to assemble. The flag will need to be attached to the servo using a screw, and the servo can be taped to the cardboard.</p>
<p>Once you have a housing created, place and affix your servo. Make sure to test along the way to make sure the housing and flag are not colliding with other elements when the servo is rotating. You can use the instructions in Step 4 to continually test until your gadget is working just the way you like.</p>
</div>
<div class="section" id="what-s-next">
<h2>What’s next<a class="headerlink" href="#what-s-next" title="Permalink to this headline">¶</a></h2>
<p>You could make a gadget that shows notifications in a variety of ways beyond using a flag. You could also use the flag to indicate something other than a notification.</p>
<p>To learn more about Alexa Gadgets Toolkit capabilities, <a class="reference external" href="https://developer.amazon.com/docs/alexa-gadgets-toolkit/features.html">review the documentation</a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="timer.html" class="btn btn-neutral float-right" title="Timer Gadget" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="wakeword.html" class="btn btn-neutral float-left" title="Wake Word LED Gadget Example" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, alexa gadgets team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>